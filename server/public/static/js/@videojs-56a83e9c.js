import{w as h}from"./global-993f03e3.js";import{r as J}from"./@babel-12f0454d.js";import{i as Y}from"./is-function-c6a25519.js";import{U as O}from"./url-toolkit-9595829e.js";var X={exports:{}},W=h,Q=function(r,e){return e===void 0&&(e=!1),function(t,i,a){if(t){r(t);return}if(i.statusCode>=400&&i.statusCode<=599){var o=a;if(e)if(W.TextDecoder){var u=Z(i.headers&&i.headers["content-type"]);try{o=new TextDecoder(u).decode(a)}catch{}}else o=String.fromCharCode.apply(null,new Uint8Array(a));r({cause:o});return}r(null,a)}};function Z(n){return n===void 0&&(n=""),n.toLowerCase().split(";").reduce(function(r,e){var t=e.split("="),i=t[0],a=t[1];return i.trim()==="charset"?a.trim():r},"utf-8")}var K=Q,G=h,b=J,rr=Y;A.httpHandler=K;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bj√∂rklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var er=function(r){var e={};return r&&r.trim().split(`
`).forEach(function(t){var i=t.indexOf(":"),a=t.slice(0,i).trim().toLowerCase(),o=t.slice(i+1).trim();typeof e[a]=="undefined"?e[a]=o:Array.isArray(e[a])?e[a].push(o):e[a]=[e[a],o]}),e};X.exports=A;X.exports.default=A;A.XMLHttpRequest=G.XMLHttpRequest||ir;A.XDomainRequest="withCredentials"in new A.XMLHttpRequest?A.XMLHttpRequest:G.XDomainRequest;nr(["get","put","post","patch","head","delete"],function(n){A[n==="delete"?"del":n]=function(r,e,t){return e=z(r,e,t),e.method=n.toUpperCase(),$(e)}});function nr(n,r){for(var e=0;e<n.length;e++)r(n[e])}function tr(n){for(var r in n)if(n.hasOwnProperty(r))return!1;return!0}function z(n,r,e){var t=n;return rr(r)?(e=r,typeof n=="string"&&(t={uri:n})):t=b({},r,{uri:n}),t.callback=e,t}function A(n,r,e){return r=z(n,r,e),$(r)}function $(n){if(typeof n.callback=="undefined")throw new Error("callback argument missing");var r=!1,e=function(T,D,V){r||(r=!0,n.callback(T,D,V))};function t(){u.readyState===4&&setTimeout(o,0)}function i(){var c=void 0;if(u.response?c=u.response:c=u.responseText||ar(u),C)try{c=JSON.parse(c)}catch{}return c}function a(c){return clearTimeout(R),c instanceof Error||(c=new Error(""+(c||"Unknown XMLHttpRequest Error"))),c.statusCode=0,e(c,H)}function o(){if(!v){var c;clearTimeout(R),n.useXDR&&u.status===void 0?c=200:c=u.status===1223?204:u.status;var T=H,D=null;return c!==0?(T={body:i(),statusCode:c,method:m,headers:{},url:p,rawRequest:u},u.getAllResponseHeaders&&(T.headers=er(u.getAllResponseHeaders()))):D=new Error("Internal XMLHttpRequest Error"),e(D,T,T.body)}}var u=n.xhr||null;u||(n.cors||n.useXDR?u=new A.XDomainRequest:u=new A.XMLHttpRequest);var l,v,p=u.url=n.uri||n.url,m=u.method=n.method||"GET",w=n.body||n.data,g=u.headers=n.headers||{},L=!!n.sync,C=!1,R,H={body:void 0,headers:{},statusCode:0,method:m,url:p,rawRequest:u};if("json"in n&&n.json!==!1&&(C=!0,g.accept||g.Accept||(g.Accept="application/json"),m!=="GET"&&m!=="HEAD"&&(g["content-type"]||g["Content-Type"]||(g["Content-Type"]="application/json"),w=JSON.stringify(n.json===!0?w:n.json))),u.onreadystatechange=t,u.onload=o,u.onerror=a,u.onprogress=function(){},u.onabort=function(){v=!0},u.ontimeout=a,u.open(m,p,!L,n.username,n.password),L||(u.withCredentials=!!n.withCredentials),!L&&n.timeout>0&&(R=setTimeout(function(){if(!v){v=!0,u.abort("timeout");var c=new Error("XMLHttpRequest timeout");c.code="ETIMEDOUT",a(c)}},n.timeout)),u.setRequestHeader)for(l in g)g.hasOwnProperty(l)&&u.setRequestHeader(l,g[l]);else if(n.headers&&!tr(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(u.responseType=n.responseType),"beforeSend"in n&&typeof n.beforeSend=="function"&&n.beforeSend(u),u.send(w||null),u}function ar(n){try{if(n.responseType==="document")return n.responseXML;var r=n.responseXML&&n.responseXML.documentElement.nodeName==="parsererror";if(n.responseType===""&&!r)return n.responseXML}catch{}return null}function ir(){}var Pr=X.exports,_="http://example.com",qr=function(r,e){if(/^[a-z]+:/i.test(e))return e;/^data:/.test(r)&&(r=h.location&&h.location.href||"");var t=typeof h.URL=="function",i=/^\/\//.test(r),a=!h.location&&!/\/\//i.test(r);if(t?r=new h.URL(r,h.location||_):/\/\//i.test(r)||(r=O.buildAbsoluteURL(h.location&&h.location.href||"",r)),t){var o=new URL(e,r);return a?o.href.slice(_.length):i?o.href.slice(o.protocol.length):o.href}return O.buildAbsoluteURL(r,e)},Gr=function(){function n(){this.listeners={}}var r=n.prototype;return r.on=function(t,i){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(i)},r.off=function(t,i){if(!this.listeners[t])return!1;var a=this.listeners[t].indexOf(i);return this.listeners[t]=this.listeners[t].slice(0),this.listeners[t].splice(a,1),a>-1},r.trigger=function(t){var i=this.listeners[t];if(!!i)if(arguments.length===2)for(var a=i.length,o=0;o<a;++o)i[o].call(this,arguments[1]);else for(var u=Array.prototype.slice.call(arguments,1),l=i.length,v=0;v<l;++v)i[v].apply(this,u)},r.dispose=function(){this.listeners={}},r.pipe=function(t){this.on("data",function(i){t.push(i)})},n}(),ur=function(r){return h.atob?h.atob(r):Buffer.from(r,"base64").toString("binary")};function zr(n){for(var r=ur(n),e=new Uint8Array(r.length),t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}var E={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},or=["video","audio","text"],U=["Video","Audio","Text"],fr=function(r){return r&&r.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,i){var a=("00"+Number(t).toString(16)).slice(-2),o=("00"+Number(i).toString(16)).slice(-2);return"avc1."+a+"00"+o})},lr=function(r){r===void 0&&(r="");var e=r.split(","),t=[];return e.forEach(function(i){i=i.trim();var a;or.forEach(function(o){var u=E[o].exec(i.toLowerCase());if(!(!u||u.length<=1)){a=o;var l=i.substring(0,u[1].length),v=i.replace(l,"");t.push({type:l,details:v,mediaType:o})}}),a||t.push({type:i,details:"",mediaType:"unknown"})}),t},$r=function(r,e){if(!r.mediaGroups.AUDIO||!e)return null;var t=r.mediaGroups.AUDIO[e];if(!t)return null;for(var i in t){var a=t[i];if(a.default&&a.playlists)return lr(a.playlists[0].attributes.CODECS)}return null},vr=function(r){return r===void 0&&(r=""),E.audio.test(r.trim().toLowerCase())},sr=function(r){return r===void 0&&(r=""),E.text.test(r.trim().toLowerCase())},cr=function(r){if(!(!r||typeof r!="string")){var e=r.toLowerCase().split(",").map(function(a){return fr(a.trim())}),t="video";e.length===1&&vr(e[0])?t="audio":e.length===1&&sr(e[0])&&(t="application");var i="mp4";return e.every(function(a){return E.mp4.test(a)})?i="mp4":e.every(function(a){return E.webm.test(a)})?i="webm":e.every(function(a){return E.ogg.test(a)})&&(i="ogg"),t+"/"+i+';codecs="'+r+'"'}},jr=function(r){return r===void 0&&(r=""),h.MediaSource&&h.MediaSource.isTypeSupported&&h.MediaSource.isTypeSupported(cr(r))||!1},Vr=function(r){return r===void 0&&(r=""),r.toLowerCase().split(",").every(function(e){e=e.trim();for(var t=0;t<U.length;t++){var i=U[t];if(E["muxer"+i].test(e))return!0}return!1})},Jr="mp4a.40.2",Yr="avc1.4d400d",xr=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,hr=/^application\/dash\+xml/i,Wr=function(r){return xr.test(r)?"hls":hr.test(r)?"dash":r==="application/vnd.videojs.vhs+json"?"vhs-json":null},pr=function(r){return r.toString(2).length},dr=function(r){return Math.ceil(pr(r)/8)},mr=function(r){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer},gr=function(r){return mr(r)},f=function(r){return r instanceof Uint8Array?r:(!Array.isArray(r)&&!gr(r)&&!(r instanceof ArrayBuffer)&&(typeof r!="number"||typeof r=="number"&&r!==r?r=0:r=[r]),new Uint8Array(r&&r.buffer||r,r&&r.byteOffset||0,r&&r.byteLength||0))},x=h.BigInt||Number,M=[x("0x1"),x("0x100"),x("0x10000"),x("0x1000000"),x("0x100000000"),x("0x10000000000"),x("0x1000000000000"),x("0x100000000000000"),x("0x10000000000000000")];(function(){var n=new Uint16Array([65484]),r=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);return r[0]===255?"big":r[0]===204?"little":"unknown"})();var Ar=function(r,e){var t=e===void 0?{}:e,i=t.signed,a=i===void 0?!1:i,o=t.le,u=o===void 0?!1:o;r=f(r);var l=u?"reduce":"reduceRight",v=r[l]?r[l]:Array.prototype[l],p=v.call(r,function(w,g,L){var C=u?L:Math.abs(L+1-r.length);return w+x(g)*M[C]},x(0));if(a){var m=M[r.length]/x(2)-x(1);p=x(p),p>m&&(p-=m,p-=m,p-=x(2))}return Number(p)},wr=function(r,e){var t=e===void 0?{}:e,i=t.le,a=i===void 0?!1:i;(typeof r!="bigint"&&typeof r!="number"||typeof r=="number"&&r!==r)&&(r=0),r=x(r);for(var o=dr(r),u=new Uint8Array(new ArrayBuffer(o)),l=0;l<o;l++){var v=a?l:Math.abs(l+1-u.length);u[v]=Number(r/M[l]&x(255)),r<0&&(u[v]=Math.abs(~u[v]),u[v]-=l===0?1:2)}return u},Tr=function(r,e){if(typeof r!="string"&&r&&typeof r.toString=="function"&&(r=r.toString()),typeof r!="string")return new Uint8Array;e||(r=unescape(encodeURIComponent(r)));for(var t=new Uint8Array(r.length),i=0;i<r.length;i++)t[i]=r.charCodeAt(i);return t},Qr=function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];if(e=e.filter(function(u){return u&&(u.byteLength||u.length)&&typeof u!="string"}),e.length<=1)return f(e[0]);var i=e.reduce(function(u,l,v){return u+(l.byteLength||l.length)},0),a=new Uint8Array(i),o=0;return e.forEach(function(u){u=f(u),a.set(u,o),o+=u.byteLength}),a},s=function(r,e,t){var i=t===void 0?{}:t,a=i.offset,o=a===void 0?0:a,u=i.mask,l=u===void 0?[]:u;r=f(r),e=f(e);var v=e.every?e.every:Array.prototype.every;return e.length&&r.length-o>=e.length&&v.call(e,function(p,m){var w=l[m]?l[m]&r[o+m]:r[o+m];return p===w})},Zr=function(r,e,t){e.forEach(function(i){for(var a in r.mediaGroups[i])for(var o in r.mediaGroups[i][a]){var u=r.mediaGroups[i][a][o];t(u,i,a,o)}})},Er=f([73,68,51]),Lr=function(r,e){e===void 0&&(e=0),r=f(r);var t=r[e+5],i=r[e+6]<<21|r[e+7]<<14|r[e+8]<<7|r[e+9],a=(t&16)>>4;return a?i+20:i+10},F=function n(r,e){return e===void 0&&(e=0),r=f(r),r.length-e<10||!s(r,Er,{offset:e})?e:(e+=Lr(r,e),n(r,e))},I=function(r){return typeof r=="string"?Tr(r):r},yr=function(r){return Array.isArray(r)?r.map(function(e){return I(e)}):[I(r)]},Cr=function n(r,e,t){t===void 0&&(t=!1),e=yr(e),r=f(r);var i=[];if(!e.length)return i;for(var a=0;a<r.length;){var o=(r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3])>>>0,u=r.subarray(a+4,a+8);if(o===0)break;var l=a+o;if(l>r.length){if(t)break;l=r.length}var v=r.subarray(a+8,l);s(u,e[0])&&(e.length===1?i.push(v):i.push.apply(i,n(v,e.slice(1),t))),a=l}return i},B={EBML:f([26,69,223,163]),DocType:f([66,130]),Segment:f([24,83,128,103]),SegmentInfo:f([21,73,169,102]),Tracks:f([22,84,174,107]),Track:f([174]),TrackNumber:f([215]),DefaultDuration:f([35,227,131]),TrackEntry:f([174]),TrackType:f([131]),FlagDefault:f([136]),CodecID:f([134]),CodecPrivate:f([99,162]),VideoTrack:f([224]),AudioTrack:f([225]),Cluster:f([31,67,182,117]),Timestamp:f([231]),TimestampScale:f([42,215,177]),BlockGroup:f([160]),BlockDuration:f([155]),Block:f([161]),SimpleBlock:f([163])},S=[128,64,32,16,8,4,2,1],Dr=function(r){for(var e=1,t=0;t<S.length&&!(r&S[t]);t++)e++;return e},k=function(r,e,t,i){t===void 0&&(t=!0),i===void 0&&(i=!1);var a=Dr(r[e]),o=r.subarray(e,e+a);return t&&(o=Array.prototype.slice.call(r,e,e+a),o[0]^=S[a-1]),{length:a,value:Ar(o,{signed:i}),bytes:o}},P=function n(r){return typeof r=="string"?r.match(/.{1,2}/g).map(function(e){return n(e)}):typeof r=="number"?wr(r):r},Fr=function(r){return Array.isArray(r)?r.map(function(e){return P(e)}):[P(r)]},Br=function n(r,e,t){if(t>=e.length)return e.length;var i=k(e,t,!1);if(s(r.bytes,i.bytes))return t;var a=k(e,t+i.length);return n(r,e,t+a.length+a.value+i.length)},q=function n(r,e){e=Fr(e),r=f(r);var t=[];if(!e.length)return t;for(var i=0;i<r.length;){var a=k(r,i,!1),o=k(r,i+a.length),u=i+a.length+o.length;o.value===127&&(o.value=Br(a,r,u),o.value!==r.length&&(o.value-=u));var l=u+o.value>r.length?r.length:u+o.value,v=r.subarray(u,l);s(e[0],a.bytes)&&(e.length===1?t.push(v):t=t.concat(n(v,e.slice(1))));var p=a.length+o.length+v.length;i+=p}return t},kr=f([0,0,0,1]),Rr=f([0,0,1]),Mr=f([0,0,3]),Sr=function(r){for(var e=[],t=1;t<r.length-2;)s(r.subarray(t,t+3),Mr)&&(e.push(t+2),t++),t++;if(e.length===0)return r;var i=r.length-e.length,a=new Uint8Array(i),o=0;for(t=0;t<i;o++,t++)o===e[0]&&(o++,e.shift()),a[t]=r[o];return a},j=function(r,e,t,i){i===void 0&&(i=1/0),r=f(r),t=[].concat(t);for(var a=0,o,u=0;a<r.length&&(u<i||o);){var l=void 0;if(s(r.subarray(a),kr)?l=4:s(r.subarray(a),Rr)&&(l=3),!l){a++;continue}if(u++,o)return Sr(r.subarray(o,a));var v=void 0;e==="h264"?v=r[a+l]&31:e==="h265"&&(v=r[a+l]>>1&63),t.indexOf(v)!==-1&&(o=a+l),a+=l+(e==="h264"?1:2)}return r.subarray(0,0)},Nr=function(r,e,t){return j(r,"h264",e,t)},Xr=function(r,e,t){return j(r,"h265",e,t)},d={webm:f([119,101,98,109]),matroska:f([109,97,116,114,111,115,107,97]),flac:f([102,76,97,67]),ogg:f([79,103,103,83]),ac3:f([11,119]),riff:f([82,73,70,70]),avi:f([65,86,73]),wav:f([87,65,86,69]),"3gp":f([102,116,121,112,51,103]),mp4:f([102,116,121,112]),fmp4:f([115,116,121,112]),mov:f([102,116,121,112,113,116]),moov:f([109,111,111,118]),moof:f([109,111,111,102])},y={aac:function(r){var e=F(r);return s(r,[255,16],{offset:e,mask:[255,22]})},mp3:function(r){var e=F(r);return s(r,[255,2],{offset:e,mask:[255,6]})},webm:function(r){var e=q(r,[B.EBML,B.DocType])[0];return s(e,d.webm)},mkv:function(r){var e=q(r,[B.EBML,B.DocType])[0];return s(e,d.matroska)},mp4:function(r){if(y["3gp"](r)||y.mov(r))return!1;if(s(r,d.mp4,{offset:4})||s(r,d.fmp4,{offset:4})||s(r,d.moof,{offset:4})||s(r,d.moov,{offset:4}))return!0},mov:function(r){return s(r,d.mov,{offset:4})},"3gp":function(r){return s(r,d["3gp"],{offset:4})},ac3:function(r){var e=F(r);return s(r,d.ac3,{offset:e})},ts:function(r){if(r.length<189&&r.length>=1)return r[0]===71;for(var e=0;e+188<r.length&&e<188;){if(r[e]===71&&r[e+188]===71)return!0;e+=1}return!1},flac:function(r){var e=F(r);return s(r,d.flac,{offset:e})},ogg:function(r){return s(r,d.ogg)},avi:function(r){return s(r,d.riff)&&s(r,d.avi,{offset:8})},wav:function(r){return s(r,d.riff)&&s(r,d.wav,{offset:8})},h264:function(r){return Nr(r,7,3).length},h265:function(r){return Xr(r,[32,33],3).length}},N=Object.keys(y).filter(function(n){return n!=="ts"&&n!=="h264"&&n!=="h265"}).concat(["ts","h264","h265"]);N.forEach(function(n){var r=y[n];y[n]=function(e){return r(f(e))}});var Hr=y,Kr=function(r){r=f(r);for(var e=0;e<N.length;e++){var t=N[e];if(Hr[t](r))return t}return""},br=function(r){return Cr(r,["moof"]).length>0};export{Yr as D,Gr as S,Pr as X,Jr as a,jr as b,$r as c,zr as d,vr as e,Zr as f,cr as g,Qr as h,mr as i,Tr as j,F as k,Kr as l,Vr as m,f as n,br as o,lr as p,qr as r,Wr as s,fr as t};
